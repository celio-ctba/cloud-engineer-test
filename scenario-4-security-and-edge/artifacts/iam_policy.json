{
  "policies": {
    "plooral-ecs-task-role-policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "DatabaseAccess",
          "Effect": "Allow",
          "Action": [
            "rds:*"
          ],
          "Resource": "*"
        },
        {
          "Sid": "MessagingAccess",
          "Effect": "Allow",
          "Action": [
            "sqs:*",
            "sns:*"
          ],
          "Resource": "*"
        },
        {
          "Sid": "ParameterStoreAccess",
          "Effect": "Allow",
          "Action": [
            "ssm:GetParameter",
            "ssm:GetParameters",
            "ssm:GetParametersByPath",
            "ssm:PutParameter",
            "ssm:DeleteParameter"
          ],
          "Resource": "*"
        },
        {
          "Sid": "S3Access",
          "Effect": "Allow",
          "Action": [
            "s3:*"
          ],
          "Resource": "*"
        },
        {
          "Sid": "KMSAccess",
          "Effect": "Allow",
          "Action": [
            "kms:Decrypt",
            "kms:GenerateDataKey"
          ],
          "Resource": "*"
        },
        {
          "Sid": "CloudWatchLogs",
          "Effect": "Allow",
          "Action": [
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:PutLogEvents"
          ],
          "Resource": "arn:aws:logs:*:*:*"
        },
        {
          "Sid": "XRayTracing",
          "Effect": "Allow",
          "Action": [
            "xray:PutTraceSegments",
            "xray:PutTelemetryRecords"
          ],
          "Resource": "*"
        }
      ]
    },
    "plooral-ecs-execution-role-policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "ECRAccess",
          "Effect": "Allow",
          "Action": [
            "ecr:GetAuthorizationToken"
          ],
          "Resource": "*"
        },
        {
          "Sid": "ECRPull",
          "Effect": "Allow",
          "Action": [
            "ecr:BatchCheckLayerAvailability",
            "ecr:GetDownloadUrlForLayer",
            "ecr:BatchGetImage"
          ],
          "Resource": "arn:aws:ecr:us-east-1:123456789012:repository/plooral-*"
        },
        {
          "Sid": "CloudWatchLogs",
          "Effect": "Allow",
          "Action": [
            "logs:CreateLogStream",
            "logs:PutLogEvents"
          ],
          "Resource": "arn:aws:logs:us-east-1:123456789012:log-group:/ecs/plooral-*:*"
        },
        {
          "Sid": "SecretsAccess",
          "Effect": "Allow",
          "Action": [
            "secretsmanager:GetSecretValue"
          ],
          "Resource": "*"
        }
      ]
    },
    "plooral-lambda-execution-role-policy": {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "SQSAccess",
          "Effect": "Allow",
          "Action": [
            "sqs:ReceiveMessage",
            "sqs:DeleteMessage",
            "sqs:GetQueueAttributes",
            "sqs:ChangeMessageVisibility"
          ],
          "Resource": [
            "arn:aws:sqs:us-east-1:123456789012:plooral-tasks",
            "arn:aws:sqs:us-east-1:123456789012:plooral-tasks-dlq"
          ]
        },
        {
          "Sid": "DatabaseAccess",
          "Effect": "Allow",
          "Action": [
            "rds-db:connect"
          ],
          "Resource": "arn:aws:rds-db:us-east-1:123456789012:dbuser:*/plooral_lambda"
        },
        {
          "Sid": "SSMAccess",
          "Effect": "Allow",
          "Action": [
            "ssm:GetParameter",
            "ssm:GetParameters"
          ],
          "Resource": "arn:aws:ssm:us-east-1:123456789012:parameter/plooral/prod/*"
        },
        {
          "Sid": "KMSDecrypt",
          "Effect": "Allow",
          "Action": [
            "kms:Decrypt"
          ],
          "Resource": "arn:aws:kms:us-east-1:123456789012:key/plooral-ssm-key"
        },
        {
          "Sid": "CloudWatchLogs",
          "Effect": "Allow",
          "Action": [
            "logs:CreateLogStream",
            "logs:PutLogEvents"
          ],
          "Resource": "arn:aws:logs:us-east-1:123456789012:log-group:/aws/lambda/plooral-worker:*"
        },
        {
          "Sid": "XRayTracing",
          "Effect": "Allow",
          "Action": [
            "xray:PutTraceSegments",
            "xray:PutTelemetryRecords"
          ],
          "Resource": "*"
        }
      ]
    }
  }
}
